<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Rules xmlns="http://www.smartdec.ru/SmartCheck/Conditions" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.smartdec.ru/SmartCheck/Conditions rules-grammar-schema.xsd ">
    <Rule>
        <RuleId>VYPER_BALANCE_EQUALITY</RuleId>
        <Patterns>
            <!-- фиксирует конструкции: ".balance ==", ".balance !="-->
            <Pattern patternId="5094ad">
                <Categories>
                    <Category>Vyper</Category>
                </Categories>
                <Severity>1</Severity>
                <XPath>
                    //comparison
                        [comp_op[text()[1]="!=" or text()[1]="=="]]
                        [expr//atom_expr/trailer[text()[1]=".balance"]]
                </XPath>
            </Pattern>
        </Patterns>
    </Rule>
    <Rule>
        <RuleId>VYPER_ERC20_APPROVE</RuleId>
        <Patterns>
            <!--Фиксирует определение функции approve-->
            <Pattern patternId="af782c">
                <Categories>
                    <Category>Vyper</Category>
                </Categories>
                <Severity>2</Severity>
                <XPath>
                    //funcdef[matches(text()[1],"approve","i")]
                </XPath>
            </Pattern>
        </Patterns>
    </Rule>
    <Rule>
        <RuleId>VYPER_PRIVATE_MODIFIER_DONT_HIDE_DATA</RuleId>
        <Patterns>
            <!-- Фиксируется определение state переменных с типом видимости private -->
            <Pattern patternId="lo771p">
                <Categories>
                    <Category>Vyper</Category>
                </Categories>
                <Severity>1</Severity>
                <XPath>
                    /file_input/stmt/simple_stmt/small_stmt/expr_stmt[not(annassign//atom_expr/trailer)][annassign]
                </XPath>
            </Pattern>
        </Patterns>
    </Rule>
</Rules>
