<?xml version="1.0" encoding="UTF-8"?>
<Rules xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="./rules.xsd">
    <VersionDefinition>//pragmaDirective[pragmaName='solidity']/pragmaValue/version/versionConstraint/text()</VersionDefinition>
    <Rule id="SOLIDITY_CALL_VALUE">
        <Pattern id="8a1602" severity="2">
            //externalFunctionCallNotThis[functionName/identifier[matches(text()[1],"^call$")]]
            [functionName/identifier[matches(text()[1],"^value$")]]
            [functionCallArguments[1][matches(text()[1],"\(")][matches(text()[1],"\)")]
            ][functionCallArguments[2][matches(text()[1],"\(")][matches(text()[1],"\)")]
            ]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_REENTRANCY_EXTERNAL_CALL"><!--пока не работает-->
        <Pattern id="1330c4" severity="2">
            //block/statement[//functionCall/externalFunctionCall]/following-sibling::*[//statement//functionCall/externalFunctionCall]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_RECOMENDATION_SEND_CALL">
        <Pattern id="1427c4" severity="2">
            //externalFunctionCallNotThis[functionName/identifier[matches(text()[1],"^call$")]]
            [functionName/identifier[matches(text()[1],"^value$")]]
            [functionCallArguments[matches(text()[1],"\(")][matches(text()[1],"\)")]
            ]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_TX_ORIGIN">
        <Pattern id="5508c4" severity="2">
            //externalFunctionCallNotThis[callObject/identifier[matches(text()[1],"tx")]][matches(text()[1],".")][functionName/identifier[matches(text()[1],"origin")]]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_EXCEPTION_DISORDER"><!--еще доделать так, чтобы была проверка "не было проверки возвр. значения"-->
        <Pattern id="ce0826" severity="3">
            //externalFunctionCallNotThis/functionName/identifier[matches(text()[1],"^send$")]
        </Pattern>
        <Pattern id="ca0826" severity="3">
            //externalFunctionCallNotThis/functionName/identifier[matches(text()[1],"^call$")]
        </Pattern>
        <Pattern id="19cea2" severity="3">
            //externalFunctionCallNotThis/functionName/identifier[matches(text()[1],"^delegatecall")]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_BALANCE_EQUALITY">
        <Pattern id="7a3b44" severity="2">
            //expression[expression[expression/primaryExpression[text()[1]="this"]][text()[1]=".balance"]][text()[1]="=="]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_STYLE_GUIDE_VIOLATION">
        <Pattern id="67c4ca" severity="1">
            //eventDefinition[matches(text()[1],"^event[a-z].*$")]
        </Pattern>
        <Pattern id="4fc198" severity="1">
            //functionDefinition[matches(text()[1],"^function[A-Z].*$")]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_VAR_ZERO">
        <Pattern id="8a1549" severity="2">
            //forStatement/simpleStatement/variableDeclarationStatement[variableDeclaration//elementaryTypeName[matches(text()[1],"var")]][expression//numberLiteral[matches(text()[1],"0")]]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_CHECKS_EFFECTS_INTERACTIONS_REENTRANCY">
        <Pattern id="8a1600" severity="2">
            //functionCall/following-sibling::statement
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_GAS_LIMIT_AND_LOOPS">
        <Pattern id="8a1809" severity="2">
            //forStatement/expression[1]/expression[2]//expression[1]/argument/identifier
        </Pattern>
        <Pattern id="8a1641" severity="2">
            //forStatement/expression[1]/expression[2]/argument/identifier
        </Pattern>
    </Rule>

    <Rule id="SOLIDITY_DOS_WITH_THROW">
        <Pattern id="8a1139" severity="2">
            //ifStatement[ifCondition//externalFunctionCall][statement//throwStatement]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_DOS_WITH_THROW_LOOP">
        <Pattern id="8a1532" severity="2">
            //forStatement/statement//externalFunctionCall
        </Pattern>
        <Pattern id="8a1553" severity="2">
            //whileStatement/statement//externalFunctionCall
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_TIMESTAMP_DEPENDENCE">
        <Pattern id="8a1556" severity="2">
            //identifier[matches(text()[1],"^now$")]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_GAS_LIMIT_AND_LOOPS_FOR">
        <Pattern id="8a1600" severity="2">
            //forStatement/expression[1]/expression[2]/functionCall
        </Pattern>
        <Pattern id="8a1601" severity="2">
            //forStatement[expression[1]/expression[2]/primaryExpression/identifier]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_GAS_LIMIT_AND_LOOPS_WHILE">
        <Pattern id="8a1631" severity="2">
            //whileStatement[expression/descendant::*[functionCall]]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_BALANCE_EQUALITY">
        <Pattern id="8a1631" severity="2">
            //expression[expression/descendant::*[//externalFunctionCallThis/functionName/identifier[matches(text()[1],"^balance$")]]][matches(text()[1],"==")]
        </Pattern>
    </Rule>
    <Rule id="SOLIDITY_BYTES_BYTE">
        <Pattern id="8a1648" severity="2">
            //typeName[typeName/elementaryTypeName[matches(text()[1],"byte")]][matches(text()[1],"\[")][matches(text()[1],"\]")]
        </Pattern>
    </Rule>

</Rules>